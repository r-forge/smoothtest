gamma.covarMLE<-function(a) { # shape a (independent of scale b)
	C<-matrix(0,ncol=3,nrow=3)
	C[1,1]<-1/2*(2*trigamma(a)*a^2-2*a+2*trigamma(a)*a-3)/(a+1)/(trigamma(a)*a-1)
	C[1,2]<-1/3*1/(a+1)/(trigamma(a)*a-1)*3^(1/2)/(a+2)^(1/2)
	C[2,1]<-C[1,2]
	C[1,3]<--1/2*1/(a+1)/(trigamma(a)*a-1)*3^(1/2)/(a+2)^(1/2)/(a+3)^(1/2)
	C[3,1]<-C[1,3]
	C[2,2]<-1/3*(9*trigamma(a)*a^2-9*a+6*trigamma(a)*a-8+3*a^3*trigamma(a)-3*a^2)/(a+1)/(a+2)/(trigamma(a)*a-1)
	C[2,3]<-1/((a+1)*(a+2)*(trigamma(a)*a-1)*(a+3)^(1/2))
	C[3,2]<-C[2,3]
	C[3,3]<-1/2*(2*a^4*trigamma(a)-2*a^3+12*a^3*trigamma(a)-12*a^2+22*trigamma(a)*a^2-22*a+12*trigamma(a)*a-15)/(a+3)/(a+2)/(a+1)/(trigamma(a)*a-1)
	return(C)
}

gamma.covarMME<-function(a) { # shape a (independent of scale b)
	C<-matrix(0,ncol=2,nrow=2)
	C[1,1]<-1/3*(3*a+10)/(a+2)
	C[1,2]<--2/(a+2)/(a+3)^(1/2)
	C[2,1]<-C[1,2]
	C[2,2]<-(a^2+5*a+9)/(a+2)/(a+3)
	return(C)
}

# for betab.covarMLE we don't have an explicit expression

betab.covarMME<-function(a,b,n) { # shapes a and b and n ntrials
	C<-matrix(0,ncol=2,nrow=2)
	C[1,1]<-1/3*(192+1216*a+288*n+1216*b+464*a*n^2+4836*b*a*n+2395*a^5*b^2+2322*a^2*n+750*a^2*n^2+2708*n*b^3+70*b^7+105*b^5*a^4+81*a*b^7+366*b^6*a^2+81*a^7*b+366*b^2*a^6+831*b^3*a^5+831*b^5*a^3+1080*b^4*a^4+3*a*b^8+105*b^4*a^5+3*b*a^8+21*b^2*a^7+63*b^3*a^6+21*a^2*b^7+63*b^6*a^3+10*n^2*b^6+16*n*b^7+170*a^6*n+16*a^7*n+10*n^2*a^6+759*a^2*n^2*b^3+413*a^4*n^2*b+358*b^6+1104*a*n+640*b^3*n^2+1780*b^4*n+1720*b*n^2*a^2+8428*b*n*a^2+3112*b^3+170*b^6*n+3964*a^3*n*b^3+248*a^3*n^2*b^3+96*n^2*b^5+182*a^4*n^2*b^2+6*a^8+6*b^8+732*a^5*n+2926*a^4*b^2*n+750*n^2*b^2+68*a^5*n^2*b+1114*a^5*n*b+7941*a^2*n*b^3+759*a^3*n^2*b^2+413*a*n^2*b^4+1114*a*b^5*n+5544*b*a+1104*n*b+2628*b^2+675*a*b^6+2395*a^2*b^5+2926*a^2*n*b^4+182*a^2*n^2*b^4+2322*b^2*n+464*n^2*b+7941*b^2*n*a^3+344*n^2*b^4+1128*a*n^2*b^3+3867*b^4*a*n+3*a*b^6*n^2+6*a*n*b^7+90*a^5*n*b^3+36*a^6*n*b^2+90*a^3*n*b^5+120*a^4*n*b^4+36*a^2*n*b^6+6*a^7*n*b+732*b^5*n+1122*a^5+70*a^7+970*a^3*n*b^4+970*a^4*n*b^3+3112*a^3+30*a^3*n^2*b^4+30*a^4*n^2*b^3+8428*a*b^2*n+541*a^5*b^2*n+640*a^3*n^2+2708*a^3*n+15*a^5*n^2*b^2+153*a*b^6*n+541*a^2*b^5*n+3*a^6*n^2*b+2855*a*b^5+153*a^6*n*b+15*a^2*n^2*b^5+10704*b*a^2+68*a*n^2*b^5+2336*a^4+8198*a^4*b^2+16128*a^2*b^3+18056*b^2*a^2+11364*a^3*b+344*a^4*n^2+1780*a^4*n+96*n^2+1568*b^2*a^2*n^2+11632*b^2*a^2*n+1128*a^3*n^2*b+7596*a^3*b*n+96*a^5*n^2+10704*a*b^2+2628*a^2+7596*a*n*b^3+1720*a*n^2*b^2+1404*a*n^2*b+2336*b^4+2855*a^5*b+7246*b^4*a+11402*b^3*a^3+358*a^6+1122*b^5+11364*a*b^3+3867*a^4*n*b+16128*b^2*a^3+8198*a^2*b^4+675*a^6*b+4300*a^3*b^4+7246*a^4*b+4300*b^3*a^4)/(a+b+n+1)/(a^2+a*n+b*a+4*a+2*n+2*b+4)/(b+2)/(2+b+a)^3/(1+b+a)^2 
	C[1,2]<-(n+b+a)*(2544*n^3*b^6-36*a*n^2-14760*a^5*b^2+1665*b*a^2*n^3+394*b^10*n^2-2544*n^3*a^6+254*n^5*b^9*a+18*b^11*n^4+1617*a^3*n^3-72*a^2*n+24*b^11*a^2-360*b^2*a^10-4049*b^7*n^2-26*n^3*b^10-402*n^5*b^8+96*b^10*a^3+1248*a^10*b*n-132*a^2*n^2+408*n*b^3+4049*n^2*a^7+1548*b^7+102*n^2*b^11-224*a^3*n^8+44*a^4*n^9+1104*b^8*a^4-464*n*b^10+10296*b^5*a^4+7704*a*b^7+18636*b^6*a^2-7704*a^7*b-18636*b^2*a^6-1544*a^3*n^5-1222*a^4*n^5+1778*a^5*n^3-18912*b^3*a^5+18912*b^5*a^3-237*a^4*n^8*b-127*a^7*n^7*b+4740*a*b^8-10296*b^4*a^5-4740*b*a^8-14424*b^2*a^7-20556*b^3*a^6+14424*a^2*b^7+20556*b^6*a^3-24*n^7*b^9*a-5880*n^2*b^6-1176*n*b^7-576*a^6*n-1778*b^5*n^3+1176*a^7*n-20*n^9*b^6*a-7084*b*n^3*a^8+3382*b^4*n^4+5880*n^2*a^6+2088*a^2*b^9+10788*a^4*b^6-1848*a^9*b-2088*b^2*a^9-172*b^10*a*n^4+48*n^5*b^9+58*n^5*b^10-245*n^8*b*a^2-108*a^10*n^5*b+432*a*b^10-122*b^10*n^4-62*b^11*n^3-124*b^11*a*n^3+600*b^7*a^5-1665*a*n^3*b^2-17995*a^4*n^4*b-10788*b^4*a^6+4500*b^8*a^3-4932*b^4*a^7+2112*b^6*a^5-2112*b^5*a^6-4500*b^3*a^8+6972*a^2*b^8+4932*b^7*a^4+1848*a*b^9-432*b*a^10-12576*b^3*a^7-537*a^2*n^4*b-8011*a^2*n^2*b^3+6241*a^4*n^3*b+12029*a^4*n^2*b-6972*b^2*a^8+12576*a^3*b^7+124*b*a^11*n^3-3382*a^4*n^4+1296*b^6-4325*a^6*n^4+2*a^11*n^5-58*a^10*n^5-18*a^11*n^4-4621*a^7*n^3+13*b^3*n^2+11373*n^2*b^8*a^3+5018*n^2*b^9*a^2+1196*n^2*b^10*a+300*b*a^10*n^3+24*b^6*a^7-2*n^9*b^7-10*n^9*b^6+160*a^11*n*b-1881*a^8*n^2*b-24*n^7*b^8*a-12*n^7*b^9+1076*b^4*n-51*b*n^4-26*n^8*b^7-8*n^8*b^8-16*n^8*b^8*a-418*b^2*n^3-12161*n^5*b^5*a^3-11056*n^5*b^6*a^2-160*b^11*a*n-49*b*n^2*a^2-408*b*n*a^2-48*a^11*b+202*a^2*n^7-6*n^6*b-3974*n^5*b^7*a-422*a^6*n^7+151*a^3*n^7-380*a^4*n^7+36*b^3-692*a^5*n^7+42*n^7*a+576*b^6*n-2841*a^3*n^5*b-19706*a^5*b*n^4-8108*a^4*n^3*b^2-4054*n^2*b^5+29920*a^4*n^2*b^2-1188*a^8+1188*b^8+2822*a^4*n^5*b-6089*a^5*n^4-1472*a^5*n-36*a^11*n^4*b-26088*a^4*n^4*b^2-3856*a^4*b^2*n-11957*a^3*n^4*b^2-576*a^9+48*b^11*a+132*n^2*b^2+23678*a^5*n^2*b-2828*a^5*n*b+11393*a^5*n^5*b-3066*n^3*b^4-7493*a^5*n^3*b+120*b^9*a^4+588*n^4*b^3+3136*a^2*n*b^3+8011*a^3*n^2*b^2+537*a*n^4*b^2-24*b^7*a^6-6286*a*n^3*b^3-12029*a*n^2*b^4+2828*a*b^5*n+566*n^5*b^2+24*b^8*a^5+576*b^9+8028*a*b^6+14760*a^2*b^5-996*b^8*n^4-847*n^2*b^8-1828*n^5*b^7+468*a*n^8*b^3+4621*n^3*b^7+3856*a^2*n*b^4+395*n^6*b^7-4415*a^2*n^3*b^3-29920*a^2*n^2*b^4-1637*a^2*n^5*b+72*b^2*n+36*n^2*b-48*n^3*b-107*a*n^9*b^3-16*n^6*b^10*a+88*n^6*b^9*a-60*n^8*b^7*a-113*a^7*n^7-3136*b^2*n*a^3+4415*b^2*n^3*a^3+360*a^2*b^10-566*a^2*n^5+936*a^3*b^9+108*a*n^5*b^10-404*a^7*n^4-4*n^9*b^7*a+142*a^2*n^6-600*a^7*b^5-109*n^4*b^2-936*a^9*b^3-1104*a^8*b^4+8967*a^6*n^4*b^2-168*a^10-8*n^6*b^10-1239*n^2*b^4+168*b^10+3100*a^6*n^5-193*n^7*b^2*a+7493*a*b^5*n^3+26088*a^2*b^4*n^4-120*a^9*b^4+24*b^11+17995*a*b^4*n^4-6528*a^3*n^4*b-2454*a*n^2*b^3+4608*b^4*a*n-22469*a*b^6*n^2-11100*a*n*b^7+25900*a^5*n*b^3+25700*a^6*n*b^2-25900*a^3*n*b^5+56*n^6*b^9-25700*a^2*n*b^6+6*a*n^6-24*a^11-96*a^10*b^3+11100*a^7*n*b-23105*a^2*n^2*b^6+1472*b^5*n+23105*a^6*n^2*b^2-24188*a^3*n^2*b^5+24188*a^5*n^2*b^3+93*n^5*b+2105*a^4*n^6-696*a^5-1548*a^7+1600*a^5*n^6-1617*n^3*b^3+1005*a^3*n^6-24*a^11*b^2+418*a^2*n^3-4440*a^3*n*b^4+1544*n^5*b^3+4440*a^4*n*b^3-36*a^3-24010*a^3*n^2*b^4+24010*a^4*n^2*b^3+1404*a^3*n^5*b^2+408*a*b^2*n-14400*a^5*n^4*b^2+8148*a^5*b^2*n-4416*a*b^7*n^4-13*a^3*n^2-408*a^3*n+21408*a^3*n^3*b^4-21408*a^4*n^3*b^3+14018*a^4*n^5*b^2-8502*a*n^2*b^7+26*a^10*n^3-8536*a^4*n^4*b^3-6319*a^6*b*n^4+21646*a*n^3*b^6-38385*a^5*n^3*b^2+42394*a^5*n^2*b^2-10882*a*n^5*b^6+237*a*n^8*b^4-4884*a*b^6*n-8148*a^2*b^5*n+22469*a^6*n^2*b+5304*a*b^5+4884*a^6*n*b-112*a*n^9*b^4-21646*a^6*n^3*b-42394*a^2*n^2*b^5-36*b*a^2+8108*a^2*n^3*b^4-1495*a^6*n^6*b-6241*a*n^3*b^4-23678*a*n^2*b^5+1637*a*n^5*b^2+6528*a*n^4*b^3+10882*a^6*b*n^5+20937*a^5*n^5*b^2+2236*a^5*n^6*b+4134*a^3*n^6*b+5735*a^4*n^6*b+136*a^6*n^6+11957*a^2*n^4*b^3+41172*b^3*a^6*n+20868*b^4*a^5*n+1011*a^2*n^6*b-151*n^7*b^3+9716*b*a^8*n+28724*b^2*a^7*n-228*a^4-6720*a^4*b^2+1428*a^2*b^3-24*a^8*b^5-2766*a^8*n^3-456*a^3*b+1239*a^4*n^2-1076*a^4*n-62*b^11*n^3*a^2-12*b^9*n^7*a^2+42*b^10*n^5*a^2+18*b^11*n^4*a^2+354*b^9*n^5*a^2+22*b^10*n^4*a^2+8*b^9*n^6*a^2+224*b^3*n^8+166*b^4*n^8+21*b^5*n^8+2454*a^3*n^2*b-2224*a^3*b*n-794*b*a^9*n^3-3958*b^2*a^8*n^3-6719*b^3*a^7*n^3-4870*b^4*a^6*n^3-568*n^4*b^9-61*n^9*b^5*a+2766*n^3*b^8+4054*a^5*n^2-93*a*n^5+12848*a^7*n^4*b^2+10809*a^5*n^4*b^4+42*a^9*n^4*b^3+19991*a^6*n^4*b^3-1218*n^7*b^3*a^4+4234*a^8*n^4*b+3066*a^4*n^3+31108*n*b^3*a^7-27500*n*b^6*a^4-908*n^7*a^6*b-1971*n^7*a^5*b^2+27500*n*b^4*a^6+36*a*b^2-37*n^8*b^6-27*n^9*b^5+522*a^10*n^3*b^2+1194*a^9*n^3*b^3+2036*a^8*n^3*b^4-204*a^11*n^2*b+2334*a^8*n^3*b^3+2630*a^6*n^3*b^5-3018*a^9*n^2*b^3-4052*a^8*n^2*b^4-2870*a^7*n^2*b^5+4428*a^7*n^3*b^4-332*a^8*n^4*b^4+5184*a^8*n^4*b^2+10098*a^7*n^4*b^3+9466*a^6*n^4*b^4+774*a^9*n^3*b^2+1358*a^9*n^4*b-1296*b^9*n-34498*b^3*n^3*a^6+17697*b^5*n^3*a^4-3022*b*n^2*a^9-10151*b^2*n^2*a^8-17697*b^4*n^3*a^5+18585*b^6*n^2*a^4+6488*b^5*n*a^6-6488*b^6*n*a^5-14484*b^7*n*a^4-23201*b^2*n^3*a^7+14484*b^4*n*a^7-1210*a^10*n^2*b^2-19460*b^3*n^2*a^7-18585*b^4*n^2*a^6-311*n^7*a^5*b^3-80*b^6*n*a^7+80*b^7*n*a^6-80*b^8*n*a^5-376*n^7*a^6*b^2-1530*n^6*b*a^7-3951*n^6*b^2*a^6-4572*n^6*b^3*a^5+272*a^6*n^7*b^3+16964*b^2*n*a^8+4624*b*n*a^9+248*a^10*n^3*b^3+62*a^8*n^3*b^5+2870*n^2*b^7*a^5+310*a^9*n^3*b^4+2224*a*n*b^3+49*a*n^2*b^2-1056*a^7*n^5*b^4-510*a^9*n^2*b^4+102*a^7*n^2*b^6-690*a^8*n^5*b^3-102*a^8*n^2*b^5+24*a^9*n^7*b-400*b^9*n*a^4+400*a^9*n*b^4+80*a^8*n*b^5-408*a^10*n^2*b^3+320*a^10*n*b^3+80*a^11*b^2*n+48*a*n^3+4052*n^2*b^8*a^4-102*a^11*n^2*b^2+228*b^4-62*a^7*n^3*b^6-4975*n^2*b^3*a^6-2806*n^2*b^4*a^5+2806*n^2*b^5*a^4-3538*n^2*b^2*a^7-43*n^9*b^2*a-395*a^7*n^6+231*n^6*b^8-698*a^7*n^4*b^5-4428*n^3*b^7*a^4-2630*n^3*b^6*a^5+4416*a^7*b*n^4+1476*n^6*b^5*a^4+2719*n^6*b^6*a^3+1158*a^7*n^5*b^2+1262*a^6*n^5*b^3+376*a^5*n^5*b^4+224*a^8*n^5*b+109*a^2*n^4+3488*a^8*n*b^4+2096*a^7*n*b^5-9466*n^4*b^6*a^4+2832*a^9*n*b^3-5304*a^5*b+2124*b^4*a-1296*a^6+24*a^8*n^7*b+1632*a^8*n^4*b^3+1354*a^7*n^4*b^4+454*a^6*n^4*b^5+922*a^9*n^4*b^2+1958*a^7*n^3*b^5+696*b^5-376*n^5*b^5*a^4-102*a^6*n^2*b^7-814*a^8*n^5*b^2-2168*a^7*n^5*b^3-2620*a^6*n^5*b^4-20868*b^5*n*a^4-18695*n^3*b*a^7+1104*b^2*n*a^10-46038*n^3*b^2*a^6-47545*n^3*b^3*a^5+193*a^2*n^7*b-2822*n^5*b^4*a+19706*n^4*b^5*a+1495*n^6*b^6*a-10809*n^4*b^5*a^4-2105*b^4*n^6+456*a*b^3+51*a*n^4-88*a^9*n^6*b+16*a^10*n^6*b+38385*b^5*a^2*n^3-28724*b^7*a^2*n-9716*b^8*a*n+4870*b^6*a^4*n^3-41172*b^6*a^3*n-8967*a^2*b^6*n^4-231*a^8*n^6+8502*a^7*n^2*b+698*a^5*n^4*b^7-10098*a^3*n^4*b^7-5184*a^2*n^4*b^8+332*a^4*n^4*b^8+1828*a^7*n^5-82*a^2*n^9*b^3-1932*n*b^8-119*a^2*n^8-12848*a^2*n^4*b^7-4234*a*n^4*b^8-19991*a^3*n^4*b^6+1971*n^7*a^2*b^5+794*a*n^3*b^9+908*n^7*a*b^6-588*a^3*n^4+6719*b^7*a^3*n^3-31108*n*b^7*a^3-16964*n*b^8*a^2-4624*n*b^9*a+1218*n^7*a^3*b^4+3958*b^8*a^2*n^3+119*n^8*b^2+21*n^8*b+404*n^4*b^7+692*n^7*b^5-136*n^6*b^6-3100*n^5*b^6+6089*n^4*b^5+4325*n^4*b^6+3018*a^3*n^2*b^9-1958*a^5*n^3*b^7-2036*a^4*n^3*b^8+1210*a^2*n^2*b^10-4608*a^4*n*b-2334*a^3*n^3*b^8-774*a^2*n^3*b^9+19460*b^7*n^2*a^3+10151*b^8*n^2*a^2-56*a^9*n^6+8*a^10*n^6+72*n^4*b^10*a^3+138*n^5*b^9*a^3-8*n^5*b^10*a^3+847*a^8*n^2-512*a^9*n^2+3022*b^9*n^2*a-5760*b^9*n*a^2-1248*b^10*n*a+34498*b^6*n^3*a^3+23201*b^7*n^3*a^2-12588*b^8*n*a^3+7084*b^8*n^3*a+199*a^5*n^7*b^4-199*a^4*n^7*b^5-272*a^3*n^7*b^6-509*a^8*n^6*b+1696*n^6*b^7*a^2+311*n^7*a^3*b^5+376*n^7*a^2*b^6+3951*n^6*b^6*a^2+1530*n^6*b^7*a+4572*n^6*b^5*a^3+1511*a^5*n^5-320*b^10*n*a^3-80*b^11*n*a^2+610*a^5*n^5*b^6+690*a^3*n^5*b^8+1056*a^4*n^5*b^7+102*a^5*n^2*b^8+510*a^4*n^2*b^9+408*a^3*n^2*b^10-610*a^6*n^5*b^5+6319*n^4*b^6*a+62*a^6*n^3*b^7-62*a^5*n^3*b^8-310*a^4*n^3*b^9-1428*b^2*a^3-1511*n^5*b^5-1600*n^6*b^5+1222*n^5*b^4+380*n^7*b^4+2298*a^2*b^5*n^6-88*a^2*b^4*n^9+6720*a^2*b^4-8028*a^6*b+204*n^2*b^11*a+6286*b*a^3*n^3+4975*n^2*b^6*a^3+3538*n^2*b^7*a^2+1881*n^2*b^8*a-248*a^3*n^3*b^10-42*a^3*n^4*b^9+245*a^4*n^6*b^6-300*n^3*b^10*a-1358*n^4*b^9*a-2096*a^5*n*b^7-3488*a^4*n*b^8-2832*a^3*n*b^9-1104*a^2*n*b^10+8892*a^5*b^3*n^4-2236*n^6*b^5*a+509*a*n^6*b^8-5735*n^6*b^4*a-11393*n^5*b^5*a+1975*n^7*b^4*a+113*b^7*n^7+127*b^7*n^7*a-1325*a^3*n^7*b^2+82*a^3*n^9*b^2+88*a^4*n^9*b^2+98*a^4*n^8*b^2-3*n^9*b-1262*a^3*n^5*b^6-224*a*n^5*b^8-1158*a^2*n^5*b^7+390*a^3*n^6*b^7-4*n^5*b^11*a-922*a^2*n^4*b^9+102*a^2*n^2*b^11-522*a^2*n^3*b^10-454*a^5*n^4*b^6-1354*a^4*n^4*b^7-1632*a^3*n^4*b^8-1194*a^3*n^3*b^9+3*a*n^9+47545*n^3*b^5*a^3+18695*n^3*b^7*a+46038*n^3*b^6*a^2+2620*a^4*n^5*b^6+814*a^2*n^5*b^8+2168*a^3*n^5*b^7+512*n^2*b^9-1005*b^3*n^6-14441*n^2*b^4*a^7+6992*n^2*b^6*a^5+14441*n^2*b^7*a^4-6992*n^2*b^5*a^6+3974*n^5*b*a^7+11056*n^5*b^2*a^6+12161*n^5*b^3*a^5-11373*a^8*n^2*b^3+996*a^8*n^4+568*a^9*n^4-44*n^9*b^4-40*n^9*b^3+2841*a*n^5*b^3-4134*a*n^6*b^3+464*a*n^7*b^3+4*n^9*a^7*b+8280*a^3*b^4-202*b^2*n^7+18*a^2*n^9+122*a^10*n^4+62*a^11*n^3-2124*a^4*b-8280*b^3*a^4+402*a^8*n^5-1696*n^6*b^2*a^7-2719*n^6*b^3*a^6-1476*n^6*b^4*a^5-48*a^9*n^5+4*a^11*n^5*b+172*a^10*n^4*b-254*a^9*n^5*b-1011*a*n^6*b^2+10*n^9*a^6-21*a*n^8-390*a^7*n^6*b^3-5018*b^2*a^9*n^2-245*a^6*n^6*b^4+245*a*n^8*b^2+2*n^9*a^7-18*b^2*n^9+20*n^9*a^6*b+16*n^8*a^8*b+60*n^8*a^7*b+684*b^9*n^3-80*b^11*n+1325*a^2*n^7*b^3+5760*b^2*a^9*n-1196*a^10*n^2*b+12588*b^3*a^8*n-18*a^6*n^4*b^7+43*a^2*n^9*b-72*b^3*a^10*n^4+62*b^2*a^11*n^3+8*b^2*a^10*n^6+8*b^3*a^10*n^5-42*b^2*a^10*n^5+10*b^4*a^9*n^5+12*b^2*a^9*n^7+24*b^3*a^9*n^6+2*b^2*a^11*n^5-18*b^2*a^11*n^4-138*b^3*a^9*n^5-354*b^2*a^9*n^5-8*b^2*a^9*n^6-22*b^2*a^10*n^4-90*b^4*a^9*n^4-141*n^8*b^6*a+422*n^7*b^6+18*a^7*n^4*b^6+122*a^7*n^5*b^5+163*a^7*n^6*b^4-18*a^8*n^4*b^5+2*a^6*n^5*b^7-52*a^8*n^5*b^4-8*a^7*n^6*b^5+154*a^6*n^6*b^5-2*a^7*n^5*b^6-15*a^8*n^6*b^3-122*a^5*n^5*b^7+16*a^8*n^6*b^4+2*a^8*n^5*b^5+1204*b^4*a^3*n^6-20937*b^5*a^2*n^5-11976*b^4*a^3*n^5-8892*b^5*a^3*n^4+3510*b^2*a^4*n^6-1204*b^3*a^4*n^6-14018*b^4*a^2*n^5+14400*b^5*a^2*n^4-4129*b^3*a^2*n^6+18*a^5*n^4*b^8-154*a^5*n^6*b^6-150*a^4*n^7*b^6-163*a^4*n^6*b^7-3510*b^4*a^2*n^6+11976*b^3*a^4*n^5+4129*b^2*a^3*n^6+8536*b^4*a^3*n^4-2298*b^2*a^5*n^6+150*a^6*n^7*b^4-394*a^10*n^2-102*a^11*n^2-104*n^8*b^5*a+26*n^8*a^7+8*n^8*a^8+40*a^3*n^9-2*b^11*n^5*a^2-8*b^10*n^6*a^2-2*n^5*b^11+99*a^7*n^7*b^3+24*a^8*n^7*b^3+85*a^7*n^7*b^2-309*a^8*n^6*b^2-24*a^3*n^6*b^9-16*a^4*n^6*b^8+15*n^6*b^8*a^3+309*n^6*b^8*a^2+1932*a^8*n+1296*a^9*n+80*a^11*n+464*a^10*n+36*b^11*n^4*a-12*a^6*n^7*b^5-166*a^4*n^8-21*a^5*n^8-1975*a^4*n^7*b+61*a^5*n^9*b+104*a^5*n^8*b+8*a^5*n^6*b^7+12*a^5*n^7*b^6-1404*a^2*n^5*b^3-684*a^9*n^3-464*a^3*n^7*b-468*a^3*n^8*b+107*a^3*n^9*b+27*a^5*n^9+2*n^9*b^2*a^7+42*n^8*b^2*a^7+48*n^7*b^2*a^8+8*n^8*b^2*a^8+8*n^8*b^3*a^7+3*n^9*b^3*a^5+196*n^8*b^3*a^5+163*n^8*b^2*a^6+10*n^9*b^2*a^6+296*n^8*b^2*a^5+51*n^8*b^3*a^6+202*n^8*b^3*a^4-202*a^3*b^4*n^8+25*a^5*b^4*n^8-163*a^2*b^6*n^8-39*a^2*b^5*n^9-85*a^2*b^7*n^7-24*a^3*b^8*n^7-8*a^3*b^7*n^8-18*a^3*b^4*n^9-2*a^2*b^7*n^9-2*a^5*b^4*n^9-8*a^2*b^8*n^8-196*a^3*b^5*n^8-25*a^4*b^5*n^8-8*a^6*b^4*n^8-296*a^2*b^5*n^8-48*a^2*b^8*n^7-42*a^2*b^7*n^8-51*a^3*b^6*n^8-99*a^3*b^7*n^7-3*a^3*b^5*n^9-10*a^2*b^6*n^9+8*a^4*b^6*n^8+2*a^4*b^5*n^9+141*a^6*n^8*b+112*a^4*n^9*b+37*a^6*n^8-2862*n^7*b^2*a^4-2141*n^7*a^5*b+2862*n^7*a^2*b^4+2141*n^7*a*b^5-98*a^2*n^8*b^4-2*n^5*b^8*a^5-10*n^5*b^9*a^4+52*n^5*b^8*a^4+90*n^4*b^9*a^4-142*n^6*b^2+39*a^5*n^9*b^2-42*n^7*b+195*a^2*n^8*b^3-195*a^3*n^8*b^2+12*a^9*n^7+18*a^4*n^9*b^3)*a^3*n^3*b^3/((1+b)^3*(b+2)*b^5*(n-2)*(n-1)^3*n^5*(a^2+a*n+b*a+4*a+2*n+2*b+4)*(a*n+n+b*a+b+2*a+a^2+1)^3*(n+b+a)^5*a^5/(5+b+a)/(4+b+a)^2/(3+b+a)^2/(2+b+a)^2/(a+b)^7/(1+b+a))^(1/2)/(a^3+3*b*a^2+3*a*b^2+b^3)/(2+b+a)^4/(a^2+2*b*a+4*a+4*b+b^2+3)/(b*(6+6*b^2+b^3+11*b)*n*(11*n-6*n^2+n^3-6)*a*(36*a+36*n+36*b+229*a*n^2+458*b*a*n+6*a^5*b^2+24*b*a^2*n^3+30*a^3*n^3+386*a^2*n+300*a^2*n^2+24*n*b^3+4*a^6*n+12*a^4*n^2*b+198*a*n+240*b*n^2*a^2+600*b*n*a^2+36*b^3+4*a^3*n*b^3+42*a^5*n+12*a^4*b^2*n+36*n^2*b^2+12*a^5*n*b+24*a^2*n*b^3+6*a^3*n^2*b^2+198*b*a+132*n*b+66*b^2+108*b^2*n+108*n^2*b+24*n^3*b+90*b^2*n*a^3+58*a^5+a^7+80*a^2*n^3+193*a^3+270*a*b^2*n+185*a^3*n^2+360*a^3*n+386*b*a^2+36*n^3+144*a^4+54*a^4*b^2+80*a^2*b^3+300*b^2*a^2+360*a^3*b+54*a^4*n^2+174*a^4*n+66*n^2+36*b^2*a^2*n^2+240*b^2*a^2*n+90*a^3*n^2*b+370*a^3*b*n+6*a^5*n^2+4*a^4*n^3+229*a*b^2+132*a^2+44*b*n^3*a+44*a*n*b^3+66*a*n^2*b^2+90*a*n^3+270*a*n^2*b+6*b^4+6*n^4+6*a^2*n^4+42*a^5*b+11*b^4*a+30*b^3*a^3+12*a^6+90*a*b^3+11*a*n^4+a^3*n^4+108*a^4*n*b+185*b^2*a^3+6*a^2*b^4+4*a^6*b+4*b*a^3*n^3+a^3*b^4+174*a^4*b+4*b^3*a^4)/(2*a+2*b+2*b*a+b^2+a^2)/(b+a+7)/(1+b+a)/(3+b+a)^2/(4+b+a)^2/(5+b+a)^2/(b+a+6)^2)^(1/2)/(a^2+2*b*a+9*a+20+9*b+b^2)/(b+a+6)/(1+b+a)^2/(3+b+a)^2/(a+b)
	C[2,1]<-C[1,2]
	C[2,2]<-1/2*(64800+410400*a+88560*n+410400*b+14925*n^3*b^6+197712*a*n^2+2616306*b*a*n+10330360*a^5*b^2+359415*b*a^2*n^3+42*b^10*n^2+14925*n^3*a^6+124431*a^3*n^3+10*b^12*a+1295733*a^2*n+152*b^11*a^2+3542*b^2*a^10+44634*b^7*n^2+928*b^10*a^3+1044*a^10*b*n+490380*a^2*n^2+1981449*n*b^3+44634*n^2*a^7+429318*b^7+45180*b^8*a^4+834*n*b^10+5672184*b^5*a^4+1171086*a*b^7+4534126*b^6*a^2+1171086*a^7*b+4534126*b^2*a^6+45996*a^5*n^3+9639226*b^3*a^5+9639226*b^5*a^3+12297060*b^4*a^4+299280*a*b^8+5672184*b^4*a^5+299280*b*a^8+1399206*b^2*a^7+3604230*b^3*a^6+1399206*a^2*b^7+3604230*b^6*a^3+157854*n^2*b^6+228921*n*b^7+666495*a^6*n+45996*b^5*n^3+228921*a^7*n+302*b*n^3*a^8+157854*n^2*a^6+41730*a^2*b^9+1754754*a^4*b^6+52464*a^9*b+41730*b^2*a^9+5928*a*b^10+80904*b^7*a^5+359415*a*n^3*b^2+1754754*b^4*a^6+156078*b^8*a^3+356850*b^4*a^7+532350*b^6*a^5+532350*b^5*a^6+156078*b^3*a^8+2164056*b^5*a^5+297570*a^2*b^8+356850*b^7*a^4+52464*a*b^9+5928*b*a^10+921540*b^3*a^7+529926*a^2*n^3*b^2+4671858*a^2*n^2*b^3+222608*a^4*n^3*b+2192526*a^4*n^2*b+297570*b^2*a^8+921540*a^3*b^7+1035690*b^6+3075*a^7*n^3+505152*a*n+690954*b^3*n^2+1794*n^2*b^8*a^3+372*n^2*b^9*a^2+30*n^2*b^10*a+9912*b^6*a^7+30*a^11*n*b+12534*a^8*n^2*b+1989030*b^4*n+12*a^12+104997*b^2*n^3+30*b^11*a*n+2260170*b*n^2*a^2+6086025*b*n*a^2+380*a^11*b+10*a^12*b+1992438*b^3+666495*b^6*n+17146896*a^3*n*b^3+4252668*a^3*n^2*b^3+232381*a^4*n^3*b^2+379092*n^2*b^5+3103032*a^4*n^2*b^2+127656*a^8+127656*b^8+1371084*a^5*n+12549869*a^4*b^2*n+316656*a^3*n^3*b^3+26604*a^9+380*b^11*a+490380*n^2*b^2+1134552*a^5*n^2*b+4642916*a^5*n*b+93558*n^3*b^4+88978*a^5*n^3*b+3162*b^9*a^4+15809778*a^2*n*b^3+4671858*a^3*n^2*b^2+9912*b^7*a^6+356901*a*n^3*b^3+2192526*a*n^2*b^4+4642916*a*b^5*n+2323116*b*a+505152*n*b+1171278*b^2+6828*b^8*a^5+26604*b^9+3243662*a*b^6+10330360*a^2*b^5+8232*n^2*b^8+3075*n^3*b^7+12549869*a^2*n*b^4+445062*a^2*n^3*b^3+3103032*a^2*n^2*b^4+1295733*b^2*n+197712*n^2*b+51120*n^3*b+15809778*b^2*n*a^3+445062*b^2*n^3*a^3+3542*a^2*b^10+16380*a^3*b^9+97860*a^6*b^6+80904*a^7*b^5+16380*a^9*b^3+45180*a^8*b^4+3708*a^10+622212*n^2*b^4+3708*b^10+88978*a*b^5*n^3+3162*a^9*b^4+312*b^11+2808798*a*n^2*b^3+7564456*b^4*a*n+392004*a*b^6*n^2+584861*a*n*b^7+5284539*a^5*n*b^3+2418240*a^6*n*b^2+5284539*a^3*n*b^5+6792904*a^4*n*b^4+2418240*a^2*n*b^6+312*a^11+928*a^10*b^3+584861*a^7*n*b+377418*a^2*n^2*b^6+1371084*b^5*n+90*b^4*a^10+377418*a^6*n^2*b^2+1089804*a^4*n^2*b^4+841698*a^3*n^2*b^5+841698*a^5*n^2*b^3+1806528*a^5+429318*a^7+124431*n^3*b^3+90*b^10*a^4+152*a^11*b^2+104997*a^2*n^3+11740741*a^3*n*b^4+11740741*a^4*n*b^3+1992438*a^3+2372088*a^3*n^2*b^4+2372088*a^4*n^2*b^3+6086025*a*b^2*n+240*b^9*a^5+6680433*a^5*b^2*n+690954*a^3*n^2+1981449*a^3*n+137363*a^3*n^3*b^4+137363*a^4*n^3*b^3+88854*a*n^2*b^7+22763*a*n^3*b^6+76551*a^5*n^3*b^2+1339890*a^5*n^2*b^2+1980601*a*b^6*n+6680433*a^2*b^5*n+392004*a^6*n^2*b+6436096*a*b^5+1980601*a^6*n*b+22763*a^6*n^3*b+1339890*a^2*n^2*b^5+5926446*b*a^2+232381*a^2*n^3*b^4+222608*a*n^3*b^4+1134552*a*n^2*b^5+1575644*b^3*a^6*n+2519328*b^4*a^5*n+10800*n^3+116434*b*a^8*n+588836*b^2*a^7*n+2262456*a^4+2*b^2*a^12+420*b^8*a^6+20*b^3*a^11+16569982*a^4*b^2+18396930*a^2*b^3+6828*a^8*b^5+360*a^8*n^3+13518324*b^2*a^2+9011898*a^3*b+622212*a^4*n^2+1989030*a^4*n+34560*n^2+504*b^7*a^7+4362372*b^2*a^2*n^2+12817074*b^2*a^2*n+2808798*a^3*n^2*b+8394867*a^3*b*n+10*b*a^9*n^3+110*b^2*a^8*n^3+460*b^3*a^7*n^3+1010*b^4*a^6*n^3+360*n^3*b^8+379092*a^5*n^2+1300*a^5*n^3*b^5+93558*a^4*n^3+304400*n*b^3*a^7+742088*n*b^5*a^5+596452*n*b^6*a^4+596452*n*b^4*a^6+5926446*a*b^2+420*a^6*n^2*b^6+14*a^8*n^3*b^3+70*a^6*n^3*b^5+48*a^9*n^2*b^3+168*a^8*n^2*b^4+336*a^7*n^2*b^5+42*a^7*n^3*b^4+2*a^9*n^3*b^2+8718*b^9*n+5662*b^3*n^3*a^6+9588*b^5*n^3*a^4+972*b*n^2*a^9+7104*b^2*n^2*a^8+9588*b^4*n^3*a^5+51702*b^6*n^2*a^4+131390*b^5*n*a^6+131390*b^6*n*a^5+86178*b^7*n*a^4+1870*b^2*n^3*a^7+86178*b^4*n*a^7+1171278*a^2+6*a^10*n^2*b^2+25284*b^3*n^2*a^7+51702*b^4*n^2*a^6+65184*b^5*n^2*a^5+756*b^6*n*a^7+756*b^7*n*a^6+504*b^8*n*a^5+92890*b^2*n*a^8+14732*b*n*a^9+206754*b*n^3*a+336*n^2*b^7*a^5+8394867*a*n*b^3+2260170*a*n^2*b^2+216*b^9*n*a^4+216*a^9*n*b^4+504*a^8*n*b^5+54*a^10*n*b^3+6*a^11*b^2*n+51120*a*n^3+1021800*a*n^2*b+168*n^2*b^8*a^4+2262456*b^4+188394*n^2*b^3*a^6+307698*n^2*b^4*a^5+307698*n^2*b^5*a^4+67446*n^2*b^2*a^7+42*n^3*b^7*a^4+70*n^3*b^6*a^5+6792*a^8*n*b^4+15540*a^6*n*b^6+12684*a^7*n*b^5+2262*a^9*n*b^3+6436096*a^5*b+9109314*b^4*a+22339152*b^3*a^3+1035690*a^6+1806528*b^5+2519328*b^5*n*a^4+3565*n^3*b*a^7+414*b^2*n*a^10+15678*n^3*b^2*a^6+47828*n^3*b^4*a^4+36387*n^3*b^3*a^5+9011898*a*b^3+76551*b^5*a^2*n^3+588836*b^7*a^2*n+116434*b^8*a*n+1010*b^6*a^4*n^3+1575644*b^6*a^3*n+2*b^12*a^2+20*b^11*a^3+88854*a^7*n^2*b+54708*n*b^8+10*a*n^3*b^9+460*b^7*a^3*n^3+304400*n*b^7*a^3+92890*n*b^8*a^2+14732*n*b^9*a+110*b^8*a^2*n^3+48*a^3*n^2*b^9+6*a^2*n^2*b^10+7564456*a^4*n*b+14*a^3*n^3*b^8+2*a^2*n^3*b^9+240*b^5*a^9+25284*b^7*n^2*a^3+7104*b^8*n^2*a^2+8232*a^8*n^2+888*a^9*n^2+972*b^9*n^2*a+8758*b^9*n*a^2+1044*b^10*n*a+5662*b^6*n^3*a^3+1870*b^7*n^3*a^2+35890*b^8*n*a^3+302*b^8*n^3*a+420*b^6*a^8+54*b^10*n*a^3+6*b^11*n*a^2+18396930*b^2*a^3+16569982*a^2*b^4+3243662*a^6*b+356901*b*a^3*n^3+188394*n^2*b^6*a^3+67446*n^2*b^7*a^2+12534*n^2*b^8*a+12684*a^5*n*b^7+6792*a^4*n*b^8+2262*a^3*n*b^9+414*a^2*n*b^10+12*b^12+36387*n^3*b^5*a^3+3565*n^3*b^7*a+15678*n^3*b^6*a^2+888*n^2*b^9+4662*n^2*b^4*a^7+7350*n^2*b^6*a^5+4662*n^2*b^7*a^4+7350*n^2*b^5*a^6+1794*a^8*n^2*b^3+17777996*a^3*b^4+9109314*a^4*b+17777996*b^3*a^4+372*b^2*a^9*n^2+18*b^9*n^3+36*b^11*n+8758*b^2*a^9*n+30*a^10*n^2*b+35890*b^3*a^8*n+42*a^10*n^2+54708*a^8*n+8718*a^9*n+36*a^11*n+834*a^10*n+18*a^9*n^3)/(a^2+2*b*a+4*a+4*b+b^2+3)^2/(36+96*a+66*n+66*b+48*a*n^2+96*b*a*n+89*a^2*n+21*a^2*n^2+127*a*n+3*b*n^2*a^2+42*b*n*a^2+6*b^3+127*b*a+72*n*b+36*b^2+18*b^2*n+18*n^2*b+a^5+a^2*n^3+47*a^3+15*a*b^2*n+3*a^3*n^2+27*a^3*n+89*b*a^2+6*n^3+11*a^4+a^2*b^3+21*b^2*a^2+27*a^3*b+3*a^4*n+36*n^2+3*b^2*a^2*n+6*a^3*b*n+48*a*b^2+97*a^2+5*a*n^3+15*a*n^2*b+5*a*b^3+3*b^2*a^3+3*a^4*b)/(b^2+5*b+6)/(2+b+a)^2/(3+b+a)
	return(C)
}

# for genpareto.covarMLE we don't have an explicit expression

genpareto.covarMME<-function(k) { # shape k (independent of scale s)
	C<-matrix(0,ncol=2,nrow=2)
	C[1,1]<-(1440*k^6+2208*k^5+1474*k^4+513*k^3+109*k^2+15*k+1)/(1+3*k)^3/(1+2*k)^3
	C[1,2]<-24*(50*k^3+55*k^2+24*k+3)*k^3/(1/(1+6*k))^(1/2)/(1+3*k)^3/(1+2*k)^3/(1/(1+8*k))^(1/2)/(1+4*k)
	C[2,1]<-C[1,2]
	C[2,2]<-(241920*k^9+357984*k^8+251280*k^7+105632*k^6+34632*k^5+9966*k^4+2205*k^3+321*k^2+27*k+1)/(1+2*k)^3/(1+3*k)^3/(1+4*k)^3
	return(C)
}

extrval.covarMLE<-function() { # independent of nuisance parameters
  	S_t1b<-matrix(c(sqrt(6)/pi,sqrt(6)/pi*gam,
                  -12*zeta(3)/pi^2/sqrt(11/90*pi^4-24*zeta(3)^2/pi^2),(pi^2/3-12*zeta(3)*gam/pi^2)/sqrt(11/90*pi^4-24*zeta(3)^2/pi^2)),nrow=2,byrow=TRUE)
  	S_bb<-matrix(c(1,-1+gam,
                 -1+gam,1+1/6*pi^2-2*gam+gam^2),nrow=2,byrow=TRUE)
  	S_t2b<-matrix(c((0.1060499473*3*pi^2/6-0.219420091),(0.1060499473*3*(2*zeta(3)+gam*pi^2/6)-0.4944037009*2*pi^2/6-0.219420091*gam), 
                  (0.02493263979*4*(2*zeta(3))-0.2416834756*3*(pi^2/6)+0.7769092062),(0.02493263979*4*(3*pi^4/20+gam*2*zeta(3))-0.2416834756*3*(2*zeta(3)+gam*pi^2/6)+0.269077145*2*(pi^2/6)+0.7769092062*gam)),nrow=2,byrow=TRUE)
	S_hb<-rbind(S_t1b,S_t2b)
	C<-diag(rep(1,4))- S_hb %*% solve(S_bb) %*% t(S_hb)
	# a little less precise: 
	#C<-matrix(c(.2249753730e-1,.9421018314e-1,.2740580591e-1,-.6344435072e-1,
      #            .9421018314e-1,.5032986969,.3673292342,-.2512184570,
      #            .2740580591e-1,.3673292342,.7185257457,.1970238182,
      #            -.6344435072e-1,-.2512184574,.1970238172,.8600794224),ncol=4,byrow=TRUE)
	# a little more precise: 
	#C[1,1]<-(pi^4-36-6*pi^2)/pi^4
	#C[1,2]<--12*5^(1/2)*3^(1/2)*(-36*zeta(3)-6*zeta(3)*pi^2+pi^4)/pi^4/(11*pi^6-2160*zeta(3)^2)^(1/2)
	#C[2,1]<-C[1,2]
	#C[2,2]<-(11*pi^10-2160*pi^4*zeta(3)^2-77760*zeta(3)^2-12960*zeta(3)^2*pi^2+4320*zeta(3)*pi^4-60*pi^8)/pi^4/(11*pi^6-2160*zeta(3)^2)
	return(C)
}

extrval.covarMME<-function() { # independent of nuisance parameters
	I <- diag(rep(1,2))
  	S_t1b <- matrix(c(sqrt(6)/pi,sqrt(6)/pi*gam,
                  -12*zeta(3)/pi^2/sqrt(11/90*pi^4-24*zeta(3)^2/pi^2),(pi^2/3-12*zeta(3)*gam/pi^2)/sqrt(11/90*pi^4-24*zeta(3)^2/pi^2)),nrow=2,byrow=TRUE)
   	S_t2b <- matrix(c((0.1060499473*3*pi^2/6-0.219420091),(0.1060499473*3*(2*zeta(3)+gam*pi^2/6)-0.4944037009*2*pi^2/6-0.219420091*gam), 
                  (0.02493263979*4*(2*zeta(3))-0.2416834756*3*(pi^2/6)+0.7769092062),(0.02493263979*4*(3*pi^4/20+gam*2*zeta(3))-0.2416834756*3*(2*zeta(3)+gam*pi^2/6)+0.269077145*2*(pi^2/6)+0.7769092062*gam)),nrow=2,byrow=TRUE)
      K <- S_t2b %*% solve(S_t1b)
      C <- I + K %*% t(K)
	return(C)
}

logis.covarMLE<-function() { # independent of nuisance parameters
	C<-matrix(c(1-9/pi^2,0,sqrt(21)/(2*pi^2),0,
                  0,1-45/(12+4*pi^2),0,3*sqrt(5)/(6+2*pi^2),
                  sqrt(21)/(2*pi^2),0,1-7/(12*pi^2),0,
                  0,3*sqrt(5)/(6+2*pi^2),0,1-1/(3+pi^2)),ncol=4,byrow=TRUE)
	return(C)
}

logis.covarMME<-function() { # independent of nuisance parameters
	I <- diag(rep(1,2))
 	S_t1b<-matrix(c(sqrt(3)/pi,0,
                  0,2/sqrt(3.2)),nrow=2,byrow=TRUE)
 	S_t2b<-matrix(c(-sqrt(7)/(6*pi),0,
                  0,-1/3),nrow=2,byrow=TRUE)
      K <- S_t2b %*% solve(S_t1b)
      C <- I + K %*% t(K)
	# a little less precise: 
	#C<-matrix(c(1.064815,0,
      #            0,1.088889),ncol=2,byrow=TRUE)
	return(C)
}

laplace.covarMLE<-function() { # independent of nuisance parameters
	C<-matrix(c(1/2, 0, 1/12*2^(1/2)*3^(1/2), 0, 
			0, 1/5, 0, 16/3725*5^(1/2)*745^(1/2), 
			1/12*2^(1/2)*3^(1/2), 0, 11/12, 0,
			0, 16/3725*5^(1/2)*745^(1/2), 0, 681/745), ncol=4, byrow=TRUE)
	return(C)
}

laplace.covarMME<-function() { # independent of nuisance parameters
	C<-matrix(c(7/6, 0,
		 	0, 165/149),nrow=2,byrow=TRUE)
	return(C)
}

# for negb.covarMLE and negb.covarMME we don't have an explicit expression

ZIP.covarMLE<-function(lambda,p) { # rate lambda and prob p
	C<-matrix(c((-lambda^3*p-2*lambda^2*p-lambda^2+2*lambda*p*exp(lambda)-2*lambda*p-2*lambda+2*exp(lambda)-2)/(lambda^2*p+2*lambda*p+2)/(exp(lambda)-1-lambda), (lambda*p^2*exp(lambda)-lambda*p^2+lambda*p-p+p*exp(lambda)+1)*lambda^(5/2)*2^(1/2)/(lambda^2*p+2*lambda*p+2)/(lambda*p+1)^(1/2)/(exp(lambda)-1-lambda)/(lambda^3*p+3*lambda^2*p+6*lambda*p+6)^(1/2), -(lambda*p^2*exp(lambda)-lambda*p^2+lambda*p-p+p*exp(lambda)+1)*6^(1/2)*lambda^3/(lambda^3*p+3*lambda^2*p+6*lambda*p+6)^(1/2)/(lambda^4*p+24*lambda*p+4*lambda^3*p+12*lambda^2*p+24)^(1/2)/(exp(lambda)-1-lambda)/(lambda*p+1)^(1/2)/(lambda^2*p+2*lambda*p+2)^(1/2),
			(lambda*p^2*exp(lambda)-lambda*p^2+lambda*p-p+p*exp(lambda)+1)*lambda^(5/2)*2^(1/2)/(lambda^2*p+2*lambda*p+2)/(lambda*p+1)^(1/2)/(exp(lambda)-1-lambda)/(lambda^3*p+3*lambda^2*p+6*lambda*p+6)^(1/2), (12*lambda^3*p^2*exp(lambda)+12*p^2*exp(lambda)*lambda^2+lambda^5*p^2*exp(lambda)+3*lambda^4*p^2*exp(lambda)+24*lambda*p*exp(lambda)+12*lambda^2*p*exp(lambda)+12*exp(lambda)-6*lambda^5*p^2-lambda^6*p^2-15*lambda^4*p^2-24*lambda^3*p^2-12*lambda^2*p^2-24*lambda*p-36*lambda^2*p-4*lambda^4*p-12*lambda^3*p-12-12*lambda-2*lambda^3)/(exp(lambda)-1-lambda)/(lambda^2*p+2*lambda*p+2)/(lambda^3*p+3*lambda^2*p+6*lambda*p+6), 2*(lambda*p^2*exp(lambda)-lambda*p^2+lambda*p-p+p*exp(lambda)+1)*lambda^(7/2)*3^(1/2)/(lambda^2*p+2*lambda*p+2)^(1/2)/(lambda^3*p+3*lambda^2*p+6*lambda*p+6)/(lambda^4*p+24*lambda*p+4*lambda^3*p+12*lambda^2*p+24)^(1/2)/(exp(lambda)-1-lambda),
			-(lambda*p^2*exp(lambda)-lambda*p^2+lambda*p-p+p*exp(lambda)+1)*6^(1/2)*lambda^3/(lambda^3*p+3*lambda^2*p+6*lambda*p+6)^(1/2)/(lambda^4*p+24*lambda*p+4*lambda^3*p+12*lambda^2*p+24)^(1/2)/(exp(lambda)-1-lambda)/(lambda*p+1)^(1/2)/(lambda^2*p+2*lambda*p+2)^(1/2), 2*(lambda*p^2*exp(lambda)-lambda*p^2+lambda*p-p+p*exp(lambda)+1)*lambda^(7/2)*3^(1/2)/(lambda^2*p+2*lambda*p+2)^(1/2)/(lambda^3*p+3*lambda^2*p+6*lambda*p+6)/(lambda^4*p+24*lambda*p+4*lambda^3*p+12*lambda^2*p+24)^(1/2)/(exp(lambda)-1-lambda), (-144-12*lambda^5*p+48*lambda^3*p*exp(lambda)+7*lambda^6*p^2*exp(lambda)+lambda^7*p^2*exp(lambda)+144*exp(lambda)+24*lambda^5*p^2*exp(lambda)+84*lambda^4*p^2*exp(lambda)+288*lambda*p*exp(lambda)+144*p^2*exp(lambda)*lambda^2-144*lambda^2*p^2-108*lambda^5*p^2-228*lambda^4*p^2-288*lambda^3*p^2-37*lambda^6*p^2-432*lambda^2*p-144*lambda+144*lambda^2*p*exp(lambda)+144*lambda^3*p^2*exp(lambda)-288*lambda*p-8*lambda^7*p^2-lambda^8*p^2-6*lambda^4-192*lambda^3*p-48*lambda^4*p)/(lambda^3*p+3*lambda^2*p+6*lambda*p+6)/(lambda^4*p+24*lambda*p+4*lambda^3*p+12*lambda^2*p+24)/(exp(lambda)-1-lambda)), nrow=3, byrow=TRUE)
	return(C)
}

ZIP.covarMME<-function(lambda,p) { # rate lambda and prob p
	C<-matrix(0,ncol=2,nrow=2)
	C[1,1]<-(lambda^3*p+5*lambda^2*p+6*lambda*p+6+2*lambda)/(lambda^3*p+3*lambda^2*p+6*lambda*p+6)
	C[1,2]<--2*lambda^(3/2)*(lambda^2*p+2*lambda*p+2)*(lambda*p+1)/((lambda^2*p+2*lambda*p+2)*(lambda^3*p+3*lambda^2*p+6*lambda*p+6))^(1/2)*3^(1/2)/((lambda^4*p+24*lambda*p+4*lambda^3*p+12*lambda^2*p+24)*(lambda^3*p+3*lambda^2*p+6*lambda*p+6))^(1/2)
	C[2,1]<-C[1,2]
	C[2,2]<-(lambda^7*p^2+7*lambda^6*p^2+36*lambda^5*p^2+12*lambda^4*p+96*lambda^4*p^2+144*lambda^3*p^2+144*lambda^2*p^2+288*lambda*p+72*lambda^3*p+144*lambda^2*p+144+12*lambda^2)/(lambda^4*p+24*lambda*p+4*lambda^3*p+12*lambda^2*p+24)/(lambda^3*p+3*lambda^2*p+6*lambda*p+6)
	return(C)
}

# unif.covarMLE is the identity matrix and is already implemented

unif.covarMME<-function() { # independent of nuisance parameters
	C<-matrix(0,ncol=2,nrow=2)
	C[1,1]<-10/3
	C[2,2]<-2.8
	return(C)
}

